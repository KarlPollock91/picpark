{"ast":null,"code":"import _slicedToArray from\"C:/Users/KarlP/new-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";//Written by Karl Pollock, 2022.\n//KarlPollock91@gmail.com\n//www.karlpollock.com\n//App.js is the top level component which ensures the user is logged in correctly before displaying child components.\nimport React,{useState,useEffect}from'react';import axios from'axios';import{Route,Routes}from'react-router-dom';import*as Constants from'../../utils/constants';import LeftSidebar from'./LeftSidebar';import Main from'./Main';import RightSidebar from'./RightSidebar';import Loading from'../secondary/Loading';import Login from'./Login';import ServerCreation from'./ServerCreation';import PostCreation from'./PostCreation';import ViewPost from'./ViewPost';import ViewProfile from'./ViewProfile';import ViewServer from'./ViewServer';import SplashPage from'./SplashPage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loggedIn=_useState4[0],setLoggedIn=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),userInfo=_useState6[0],setUserInfo=_useState6[1];//Component hook that checks if user is logged.\nuseEffect(function(){if(!localStorage.getItem(\"authToken\")){setLoading(false);setLoggedIn(false);}else{verifyAuth();}},[]);//Send the users current auth token to the server to validate.\nvar verifyAuth=function verifyAuth(){axios.get(\"\".concat(Constants.SERVER_URL,\"/accounts/verifyAuth\"),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")// \"Access-Control-Allow-Origin\": \"*\"\n}}).then(function(res){if(res.status===200){setUserInfo(res.data);setLoggedIn(true);}}).catch(function(err){localStorage.clear();});};//Log out and return to login screen.\nvar logout=function logout(){localStorage.clear();setLoggedIn(false);};var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),newServer=_useState8[0],setNewServer=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),newUser=_useState10[0],setNewUser=_useState10[1];//Refresh the items in the left sidebar.\nvar refreshLeftSidebar=function refreshLeftSidebar(){setNewServer(!newServer);};//Refresh the items in the right sidebar.\nvar refreshRightSidebar=function refreshRightSidebar(){setNewUser(!newUser);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"wrapper w-100 h-100 mw-100 mh-100\",children:/*#__PURE__*/_jsx(Loading,{})});}else if(loggedIn){return/*#__PURE__*/_jsx(\"div\",{className:\"w-100 vh-100 container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col vh-100 border border-secondary full-height\",children:/*#__PURE__*/_jsx(LeftSidebar,{newServer:newServer,userId:userInfo._id})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-auto col-8 vh-100 border border-secondary full-height\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(SplashPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/s/:serverId\",element:/*#__PURE__*/_jsx(Main,{refreshLeftSidebar:refreshLeftSidebar})}),/*#__PURE__*/_jsx(Route,{path:\"/createServer\",element:/*#__PURE__*/_jsx(ServerCreation,{refreshLeftSidebar:refreshLeftSidebar})}),/*#__PURE__*/_jsx(Route,{path:\"/post/:serverId\",element:/*#__PURE__*/_jsx(PostCreation,{})}),/*#__PURE__*/_jsx(Route,{path:\"/v/:serverId/:postId\",element:/*#__PURE__*/_jsx(ViewPost,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile/:userId\",element:/*#__PURE__*/_jsx(ViewProfile,{refreshRightSidebar:refreshRightSidebar})}),/*#__PURE__*/_jsx(Route,{path:\"/serverInfo/:serverId\",element:/*#__PURE__*/_jsx(ViewServer,{refreshLeftSidebar:refreshLeftSidebar})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col vh-100 border border-secondary\",children:/*#__PURE__*/_jsx(RightSidebar,{newUser:newUser,userInfo:userInfo,logoutCallback:logout})})]})});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"wrapper w-100 h-100\",children:/*#__PURE__*/_jsx(Login,{verifyAuth:verifyAuth})});}}export default App;","map":{"version":3,"sources":["C:/Users/KarlP/new-app/client/src/components/main/App.js"],"names":["React","useState","useEffect","axios","Route","Routes","Constants","LeftSidebar","Main","RightSidebar","Loading","Login","ServerCreation","PostCreation","ViewPost","ViewProfile","ViewServer","SplashPage","App","props","loading","setLoading","loggedIn","setLoggedIn","userInfo","setUserInfo","localStorage","getItem","verifyAuth","get","SERVER_URL","headers","then","res","status","data","catch","err","clear","logout","newServer","setNewServer","newUser","setNewUser","refreshLeftSidebar","refreshRightSidebar","_id"],"mappings":"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","sourcesContent":["//Written by Karl Pollock, 2022.\r\n//KarlPollock91@gmail.com\r\n//www.karlpollock.com\r\n\r\n//App.js is the top level component which ensures the user is logged in correctly before displaying child components.\r\n\r\nimport React, {useState, useEffect} from 'react';\r\nimport axios from 'axios';\r\nimport {Route, Routes} from 'react-router-dom';\r\n\r\nimport * as Constants from '../../utils/constants';\r\n\r\nimport LeftSidebar from './LeftSidebar';\r\nimport Main from './Main';\r\nimport RightSidebar from './RightSidebar';\r\nimport Loading from '../secondary/Loading';\r\nimport Login from './Login';\r\nimport ServerCreation from './ServerCreation';\r\nimport PostCreation from './PostCreation';\r\nimport ViewPost from './ViewPost';\r\nimport ViewProfile from './ViewProfile';\r\nimport ViewServer from './ViewServer';\r\nimport SplashPage from './SplashPage';\r\n\r\n\r\nfunction App(props) {\r\n    const [loading, setLoading] = useState(false);\r\n    const [loggedIn, setLoggedIn] = useState(false);\r\n\r\n    const [userInfo, setUserInfo] = useState();\r\n\r\n    //Component hook that checks if user is logged.\r\n    useEffect(() => {\r\n        if (!localStorage.getItem(\"authToken\")){\r\n            setLoading(false);\r\n            setLoggedIn(false);\r\n        } else {\r\n            verifyAuth();\r\n        }\r\n    }, [])\r\n\r\n    //Send the users current auth token to the server to validate.\r\n    const verifyAuth = () => {\r\n        axios.get(`${Constants.SERVER_URL}/accounts/verifyAuth`, {\r\n            headers: {\r\n                \"x-access-token\": localStorage.getItem(\"authToken\")\r\n                // \"Access-Control-Allow-Origin\": \"*\"\r\n            }\r\n            }).then((res) => {\r\n                if (res.status === 200) {\r\n                    setUserInfo(res.data)\r\n                    setLoggedIn(true);\r\n\r\n                }\r\n            }).catch((err) => {\r\n                localStorage.clear();\r\n            });\r\n    }\r\n\r\n    //Log out and return to login screen.\r\n    const logout = () => {\r\n        localStorage.clear();\r\n        setLoggedIn(false);\r\n    }\r\n\r\n\r\n    const [newServer, setNewServer] = useState(false);\r\n    const [newUser, setNewUser] = useState(false);\r\n\r\n    //Refresh the items in the left sidebar.\r\n    const refreshLeftSidebar = () => {\r\n        setNewServer(!newServer);\r\n    }\r\n    //Refresh the items in the right sidebar.\r\n    const refreshRightSidebar = () => {\r\n        setNewUser(!newUser);\r\n    }\r\n\r\n    if (loading) {\r\n        return(\r\n            <div className=\"wrapper w-100 h-100 mw-100 mh-100\">\r\n                <Loading/>\r\n            </div>\r\n        )\r\n    } else if (loggedIn) {\r\n        return(\r\n            <div className=\"w-100 vh-100 container-fluid\">\r\n                <div className=\"row\">\r\n                    <div  className=\"col vh-100 border border-secondary full-height\">\r\n                        <LeftSidebar newServer={newServer} userId={userInfo._id}/>\r\n                    </div>\r\n                    <div className=\"overflow-auto col-8 vh-100 border border-secondary full-height\">\r\n                    \r\n                        <Routes>\r\n                            <Route path=\"/\" element={<SplashPage/>}/>\r\n                            <Route path=\"/s/:serverId\" element={<Main refreshLeftSidebar={refreshLeftSidebar}/>} />\r\n                            <Route path=\"/createServer\" element={ <ServerCreation refreshLeftSidebar={refreshLeftSidebar}/>}/>\r\n                            <Route path=\"/post/:serverId\" element={<PostCreation/>}/>\r\n                            <Route path=\"/v/:serverId/:postId\" element={<ViewPost />}/>\r\n                            <Route path=\"/profile/:userId\" element={<ViewProfile refreshRightSidebar={refreshRightSidebar}/>}/>\r\n                            <Route path=\"/serverInfo/:serverId\" element={<ViewServer refreshLeftSidebar={refreshLeftSidebar}/>}/>\r\n                        </Routes>\r\n\r\n                    </div>\r\n                    <div  className=\"col vh-100 border border-secondary\">\r\n                        <RightSidebar newUser={newUser} userInfo={userInfo} logoutCallback={logout}/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n\r\n    } else {\r\n        return(\r\n            <div className=\"wrapper w-100 h-100\">\r\n                <Login verifyAuth={verifyAuth}/>\r\n            </div>\r\n        )\r\n    }\r\n    \r\n} \r\n\r\nexport default App;"]},"metadata":{},"sourceType":"module"}