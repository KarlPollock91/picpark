{"ast":null,"code":"import _slicedToArray from\"C:/Users/KarlP/new-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";//Written by Karl Pollock, 2022.\n//KarlPollock91@gmail.com\n//www.karlpollock.com\n//ViewServer.js is a component for viewing more information about a server. A user can change the server settings here,\n//view other members profiles, or leave/delete the server.\nimport React,{useState,useEffect,useRef}from'react';import{Tabs,Tab,Form,Modal,Button}from'react-bootstrap';import axios from'axios';import Avatar from'../thumbnails/Avatar';import Loading from'../secondary/Loading';import{useNavigate,useParams}from'react-router-dom';import UserThumbnail from'../thumbnails/UserThumbnail';import*as Constants from'../../utils/constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ViewServer(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),updateServer=_useState2[0],setUpdateServer=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),server=_useState4[0],setServer=_useState4[1];//Permission of the current user in relation to the server.\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),userPermission=_useState6[0],setUserPermission=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),madeChanges=_useState8[0],setMadeChanges=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),editServerName=_useState10[0],setEditServerName=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),hoverOverAvatar=_useState12[0],setHoverOverAvatar=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),previewAvatar=_useState14[0],setPreviewAvatar=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),serverUsers=_useState16[0],setServerUsers=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),loadedUsers=_useState18[0],setLoadedUsers=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),loadedSecurities=_useState20[0],setLoadedSecurities=_useState20[1];//Radio menu variables\nvar _useState21=useState(),_useState22=_slicedToArray(_useState21,2),postsVisibility=_useState22[0],setPostsVisibility=_useState22[1];var _useState23=useState(),_useState24=_slicedToArray(_useState23,2),allowJoin=_useState24[0],setAllowJoin=_useState24[1];var _useState25=useState(),_useState26=_slicedToArray(_useState25,2),allowComment=_useState26[0],setAllowComment=_useState26[1];var _useState27=useState(),_useState28=_slicedToArray(_useState27,2),usersVisibility=_useState28[0],setUsersVisibility=_useState28[1];var modalTextDict={0:\"Are you sure you want to leave this server?\",1:\"You are the only admin on this server, leaving will delete the server and all its posts. Is this okay?\"};var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),showLeaveModal=_useState30[0],setShowLeaveModal=_useState30[1];var _useState31=useState(0),_useState32=_slicedToArray(_useState31,2),leaveModalStage=_useState32[0],setLeaveModalStage=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),showRankModal=_useState34[0],setShowRankModal=_useState34[1];var _useState35=useState({}),_useState36=_slicedToArray(_useState35,2),rankModalProfile=_useState36[0],setRankModalProfile=_useState36[1];var _useState37=useState(0),_useState38=_slicedToArray(_useState37,2),rankRadio=_useState38[0],setRankRadio=_useState38[1];var navigate=useNavigate();var params=useParams();var formRef=useRef(null);//Component hook for retrieving the server information.\nuseEffect(function(){axios.get(\"\".concat(Constants.SERVER_URL,\"/servers/getServer/\").concat(params.serverId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setServer(res.data.serverObject);setUserPermission(res.data.permission);setEditServerName(res.data.serverObject.serverName);}else if(res.status===404){navigate('/picpark');}});},[navigate,params.serverId,updateServer]);//Component hook for getting the list of members of the server.\nuseEffect(function(){axios.get(\"\".concat(Constants.SERVER_URL,\"/servers/serverUsers/\").concat(params.serverId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setServerUsers(res.data);}setLoadedUsers(true);}).catch(function(err){setLoadedUsers(true);});},[params.serverId]);//Component hook for getting the server securities\nuseEffect(function(){axios.get(\"\".concat(Constants.SERVER_URL,\"/servers/serverSecurities/\").concat(params.serverId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setPostsVisibility(res.data.serverSecurities.postsVisibility);setAllowJoin(res.data.serverSecurities.allowJoin);setAllowComment(res.data.serverSecurities.allowComment);setUsersVisibility(res.data.serverSecurities.usersVisibility);}setLoadedSecurities(true);});},[params.serverId]);//Save changes made to the server.\nvar saveChanges=function saveChanges(){var fd=new FormData();fd.append(\"editServerName\",editServerName);fd.append(\"postsVisibility\",postsVisibility);fd.append(\"allowJoin\",allowJoin);fd.append(\"allowComment\",allowComment);fd.append(\"usersVisibility\",usersVisibility);if(formRef.current.files[0]&&formRef.current.files[0].name){fd.append('file-upload',formRef.current.files[0],formRef.current.files[0].name);}if(!formRef.current.files[0]||formRef.current.files[0].type.split('/')[0]===\"image\"){axios.post(\"\".concat(Constants.SERVER_URL,\"/servers/updateServer/\").concat(server._id),fd,{headers:{'x-access-token':localStorage.getItem(\"authToken\"),'Content-Type':'multipart/form-data'}}).then(function(res){if(res.status===200){setUpdateServer(!updateServer);setMadeChanges(false);props.refreshLeftSidebar();}}).catch(function(err){});}else{//err\n};};/////////////////////Leave Server Modal//////////////////////////////\n//Opens up the leave server confirmation modal when the user clicks the Leave Server button\nvar leaveServer=function leaveServer(){setLeaveModalStage(0);setShowLeaveModal(true);};//Confirms that a user wishes to leave the server. If there are no other admins in the server, the user will get a\n//confirmation that they wish to delete the server instead.\nvar leaveServerConfirm=function leaveServerConfirm(){if(leaveModalStage===0){axios.delete(\"\".concat(Constants.SERVER_URL,\"/servers/leaveServer/\").concat(params.serverId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){props.refreshLeftSidebar();setUserPermission(0);setShowLeaveModal(false);}else if(res.status===202){setLeaveModalStage(1);setShowLeaveModal(true);}});}else if(leaveModalStage===1){axios.delete(\"\".concat(Constants.SERVER_URL,\"/servers/deleteServer/\").concat(params.serverId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){props.refreshLeftSidebar();navigate(\"/picpark\");});}};//Close the leave server modal.\nvar leaveServerCancel=function leaveServerCancel(){setLeaveModalStage(0);setShowLeaveModal(false);};////////////////////////Change rank modal///////////////////////////////////\n//Open the change user rank modal.\nvar openChangeRankModal=function openChangeRankModal(userId,username,serverPermission){setRankRadio(serverPermission);setRankModalProfile({userId:userId,username:username});setShowRankModal(true);};//Handles modifying the user rank radio options.\nvar changeRankModalRadio=function changeRankModalRadio(e){switch(e.target.id){case'status-radio-0':setRankRadio(0);break;case'status-radio-1':setRankRadio(1);break;case'status-radio-2':setRankRadio(2);break;case'status-radio-3':setRankRadio(3);break;case'status-radio-4':setRankRadio(4);break;case'status-radio-5':setRankRadio(5);break;default://do nothing\nbreak;}};//Sends a request to the server to change the rank of a user.\nvar changeRank=function changeRank(){var fd=new FormData();axios.post(\"\".concat(Constants.SERVER_URL,\"/servers/changeRank/\").concat(server._id,\"/\").concat(rankModalProfile.userId,\"/\").concat(rankRadio),fd,{headers:{'x-access-token':localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setShowRankModal(false);}}).catch(function(err){});};//Returns the user to the previous page.\nvar exitViewServer=function exitViewServer(){navigate(-1);};//////////////////////Avatar change stuff////////////////\n//Event for when the user mouses over the avatar\nvar mouseOverEvent=function mouseOverEvent(e){if(userPermission>=5){setHoverOverAvatar(true);}};//Event for when the user is no longer mousing over the avatar\nvar mouseLeaveEvent=function mouseLeaveEvent(e){if(userPermission>=5){setHoverOverAvatar(false);}};//Event for when the user clicks the avatar\nvar onClickAvatar=function onClickAvatar(e){if(userPermission>=5){formRef.current.click();}};//Sets the thumbnail avatar to be a new one, and readies the data for uploading.\nvar changeAvatar=function changeAvatar(e){if(formRef.current.files[0].type.split('/')[0]===\"image\"){var reader=new FileReader();reader.onload=function(){setPreviewAvatar(reader.result);};reader.readAsDataURL(formRef.current.files[0]);setMadeChanges(true);}else{//display error\n}};//Triggers onchange in serverName field.\nvar serverNameEvent=function serverNameEvent(e){setEditServerName(e.target.value);setMadeChanges(true);};//Handles radio options for server security.\nvar securitySettingEvent=function securitySettingEvent(e){setMadeChanges(true);switch(e.target.id){case'security-radio-0-0':setPostsVisibility(0);break;case'security-radio-0-1':setPostsVisibility(1);break;case'security-radio-1-0':setAllowJoin(0);break;case'security-radio-1-1':setAllowJoin(1);break;case'security-radio-2-0':setAllowComment(0);break;case'security-radio-2-1':setAllowComment(1);break;case'security-radio-3-0':setUsersVisibility(0);break;case'security-radio-3-1':setUsersVisibility(1);break;default://do nothing\nbreak;}};//Sends the user to the Main component of the server they're viewing the information of.\nvar visitServer=function visitServer(){navigate(\"/picpark/s/\".concat(server._id));};return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center position-relative w-100 h-100\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-circle position-absolute top-0 end-0 fa-lg\",onClick:exitViewServer}),/*#__PURE__*/_jsxs(Modal,{show:showLeaveModal,onHide:function onHide(){return setShowLeaveModal(false);},children:[/*#__PURE__*/_jsx(Modal.Body,{children:modalTextDict[leaveModalStage]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:leaveServerCancel,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:leaveServerConfirm,children:\"Confirm\"})]})]}),/*#__PURE__*/_jsxs(Modal,{show:showRankModal,onHide:function onHide(){return setShowRankModal(false);},children:[/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Label,{className:\"my-auto col-md-6\",children:[\"Set User Status for \",rankModalProfile.username]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ps-5 my-auto col-md-6 border-start border-secondary\",children:[/*#__PURE__*/_jsx(Form.Check,{type:\"radio\",id:\"status-radio-0\",label:\"Banned\",checked:rankRadio===0,onChange:changeRankModalRadio}),/*#__PURE__*/_jsx(Form.Check,{type:\"radio\",id:\"status-radio-1\",label:\"Non-Member\",checked:rankRadio===1,onChange:changeRankModalRadio}),/*#__PURE__*/_jsx(Form.Check,{type:\"radio\",id:\"status-radio-2\",label:\"Member\",checked:rankRadio===2,onChange:changeRankModalRadio}),/*#__PURE__*/_jsx(Form.Check,{type:\"radio\",id:\"status-radio-3\",label:\"Super Member\",checked:rankRadio===3,onChange:changeRankModalRadio}),/*#__PURE__*/_jsx(Form.Check,{type:\"radio\",id:\"status-radio-4\",label:\"Moderator\",checked:rankRadio===4,onChange:changeRankModalRadio}),/*#__PURE__*/_jsx(Form.Check,{type:\"radio\",id:\"status-radio-5\",label:\"Admin\",checked:rankRadio===5,onChange:changeRankModalRadio})]})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:function onClick(){return setShowRankModal(false);},children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:changeRank,children:\"Confirm\"})]})]}),server?/*#__PURE__*/_jsxs(\"div\",{className:\"container start-50 translate-middle-x top-0 position-absolute w-100 mt-4 m-1 border border-secondary p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 position-relative\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",onMouseOver:mouseOverEvent,onMouseLeave:mouseLeaveEvent,onClick:onClickAvatar,children:[hoverOverAvatar?/*#__PURE__*/_jsx(\"img\",{alt:\"Click to change the avatar.\",style:{borderRadius:'50%',objectFit:'cover',height:'100px',width:'100px'},className:\"thumbnail-image start-50 top-50 translate-middle position-absolute\",src:\"\".concat(process.env.PUBLIC_URL,\"/images/server_default.png\")}):\"\",/*#__PURE__*/_jsx(Avatar,{large:true,localPreview:previewAvatar,avatarPostId:server.avatarPostId}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:changeAvatar,name:\"file-upload\",id:\"file\",ref:formRef,style:{display:\"none\"}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-8 mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:userPermission>=5?/*#__PURE__*/_jsx(\"input\",{maxLength:20,type:\"text\",value:editServerName,onInput:serverNameEvent,className:\"form-control w-75\",rows:\"1\",placeholder:\"Server Name\",\"aria-label\":\"Server Name\"}):server.serverName}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[\"Server ID: \",server._id]}),userPermission>=5?/*#__PURE__*/_jsx(\"div\",{className:\"justify-content-center mt-5 mx-auto text-center w-25 row\",children:madeChanges?/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:saveChanges,className:\"btn-md btn-outline-primary\",children:\"Save Changes\"}):\"Changes Saved\"}):\"\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row m-4\",children:/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:\"users\",id:\"uncontrolled-tab-example\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"users\",title:\"Users\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:serverUsers&&userPermission?/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:serverUsers.map(function(el,i){return el.permissions>0?/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(UserThumbnail,{userId:el.userId,changeRankCallback:openChangeRankModal,serverId:params.serverId,userPermission:userPermission})})},el._id):\"\";})}):loadedUsers?\"You do not have permission to view this server's users.\":/*#__PURE__*/_jsx(Loading,{})})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"settings\",title:\"Server Settings\",children:loadedSecurities?/*#__PURE__*/_jsx(Form,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"my-auto col-md-6\",children:\"Who can view posts?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ps-5 my-3 col-md-6 border-start border-secondary\",children:[/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-0-0\",label:\"Anyone\",checked:postsVisibility===0,onChange:securitySettingEvent}),/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-0-1\",label:\"Members Only\",checked:postsVisibility===1,onChange:securitySettingEvent})]}),/*#__PURE__*/_jsx(Form.Label,{className:\"my-auto col-md-6\",children:\"Who can join?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ps-5 my-3 col-md-6 border-start border-secondary\",children:[/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-1-0\",label:\"Anyone with a link\",checked:allowJoin===0,onChange:securitySettingEvent}),/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-1-1\",label:\"Nobody\",checked:allowJoin===1,onChange:securitySettingEvent})]}),/*#__PURE__*/_jsx(Form.Label,{className:\"my-auto col-md-6\",children:\"Who can comment on posts?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ps-5 my-3 col-md-6 border-start border-secondary\",children:[/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-2-0\",label:\"Anyone\",checked:allowComment===0,onChange:securitySettingEvent}),/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-2-1\",label:\"Members\",checked:allowComment===1,onChange:securitySettingEvent})]}),/*#__PURE__*/_jsx(Form.Label,{className:\"my-auto col-md-6\",children:\"Who can view members of the server?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ps-5 my-3 col-md-6 border-start border-secondary\",children:[/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-3-0\",label:\"Anyone\",checked:usersVisibility===0,onChange:securitySettingEvent}),/*#__PURE__*/_jsx(Form.Check,{disabled:userPermission<5,type:\"radio\",id:\"security-radio-3-1\",label:\"Members\",checked:usersVisibility===1,onChange:securitySettingEvent})]})]})}):/*#__PURE__*/_jsx(Loading,{})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"banned\",title:\"Banned Users\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:serverUsers&&userPermission?/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:serverUsers.map(function(el,i){return el.permissions===0?/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(UserThumbnail,{userId:el.userId,changeRankCallback:openChangeRankModal,serverId:params.serverId,userPermission:userPermission})})},el._id):\"\";})}):loadedUsers?\"You do not have permission to view this server's users.\":/*#__PURE__*/_jsx(Loading,{})})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-end\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:userPermission>=2?/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:leaveServer,className:\"w-100 my-2 btn-md btn-outline-primary\",children:\"Leave Server\"})}):\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:visitServer,className:\"w-100 my-2 btn-md btn-outline-primary\",children:\"Visit Server\"})})]})]}):/*#__PURE__*/_jsx(Loading,{})]});}export default ViewServer;","map":{"version":3,"sources":["C:/Users/KarlP/new-app/client/src/components/main/ViewServer.js"],"names":["React","useState","useEffect","useRef","Tabs","Tab","Form","Modal","Button","axios","Avatar","Loading","useNavigate","useParams","UserThumbnail","Constants","ViewServer","props","updateServer","setUpdateServer","server","setServer","userPermission","setUserPermission","madeChanges","setMadeChanges","editServerName","setEditServerName","hoverOverAvatar","setHoverOverAvatar","previewAvatar","setPreviewAvatar","serverUsers","setServerUsers","loadedUsers","setLoadedUsers","loadedSecurities","setLoadedSecurities","postsVisibility","setPostsVisibility","allowJoin","setAllowJoin","allowComment","setAllowComment","usersVisibility","setUsersVisibility","modalTextDict","showLeaveModal","setShowLeaveModal","leaveModalStage","setLeaveModalStage","showRankModal","setShowRankModal","rankModalProfile","setRankModalProfile","rankRadio","setRankRadio","navigate","params","formRef","get","SERVER_URL","serverId","headers","localStorage","getItem","then","res","status","data","serverObject","permission","serverName","catch","err","serverSecurities","saveChanges","fd","FormData","append","current","files","name","type","split","post","_id","refreshLeftSidebar","leaveServer","leaveServerConfirm","delete","leaveServerCancel","openChangeRankModal","userId","username","serverPermission","changeRankModalRadio","e","target","id","changeRank","exitViewServer","mouseOverEvent","mouseLeaveEvent","onClickAvatar","click","changeAvatar","reader","FileReader","onload","result","readAsDataURL","serverNameEvent","value","securitySettingEvent","visitServer","borderRadius","objectFit","height","width","process","env","PUBLIC_URL","avatarPostId","display","map","el","i","permissions"],"mappings":"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","sourcesContent":["//Written by Karl Pollock, 2022.\r\n//KarlPollock91@gmail.com\r\n//www.karlpollock.com\r\n\r\n//ViewServer.js is a component for viewing more information about a server. A user can change the server settings here,\r\n//view other members profiles, or leave/delete the server.\r\n\r\nimport React, {useState, useEffect, useRef} from 'react';\r\nimport {Tabs, Tab, Form, Modal, Button} from 'react-bootstrap';\r\nimport axios from 'axios';\r\nimport Avatar from '../thumbnails/Avatar';\r\nimport Loading from '../secondary/Loading'\r\nimport {useNavigate, useParams} from 'react-router-dom';\r\nimport UserThumbnail from '../thumbnails/UserThumbnail';\r\n\r\nimport * as Constants from '../../utils/constants';\r\n\r\nfunction ViewServer(props) {\r\n    \r\n    const [updateServer, setUpdateServer] = useState(false);\r\n\r\n    const [server, setServer] = useState(null);\r\n    \r\n    //Permission of the current user in relation to the server.\r\n    const [userPermission, setUserPermission] = useState();\r\n\r\n    const [madeChanges, setMadeChanges] = useState(true);\r\n\r\n    const [editServerName, setEditServerName] = useState('');\r\n\r\n    const [hoverOverAvatar, setHoverOverAvatar] = useState(false);\r\n    const [previewAvatar, setPreviewAvatar] = useState();\r\n\r\n    const [serverUsers, setServerUsers] = useState(null);\r\n    const [loadedUsers, setLoadedUsers] = useState(false);\r\n\r\n    const [loadedSecurities, setLoadedSecurities] = useState(false);\r\n\r\n    //Radio menu variables\r\n    const [postsVisibility, setPostsVisibility] = useState();\r\n    const [allowJoin, setAllowJoin] = useState();\r\n    const [allowComment, setAllowComment] = useState();\r\n    const [usersVisibility, setUsersVisibility] = useState();\r\n\r\n    const modalTextDict = {\r\n        0: \"Are you sure you want to leave this server?\",\r\n        1: \"You are the only admin on this server, leaving will delete the server and all its posts. Is this okay?\"\r\n    }\r\n\r\n\r\n    const [showLeaveModal, setShowLeaveModal] = useState(false);\r\n    const [leaveModalStage, setLeaveModalStage] = useState(0);\r\n\r\n    const [showRankModal, setShowRankModal] = useState(false);\r\n    const [rankModalProfile, setRankModalProfile] = useState({});\r\n    const [rankRadio, setRankRadio] = useState(0);\r\n\r\n    const navigate = useNavigate();\r\n    const params = useParams();\r\n    const formRef = useRef(null);\r\n\r\n    //Component hook for retrieving the server information.\r\n    useEffect(() => {\r\n        axios.get(`${Constants.SERVER_URL}/servers/getServer/${params.serverId}`, {headers: \r\n                {\r\n                    \"x-access-token\": localStorage.getItem(\"authToken\")\r\n                }\r\n        }).then((res) => {\r\n            if (res.status === 200) {\r\n                setServer(res.data.serverObject);\r\n                setUserPermission(res.data.permission);\r\n                setEditServerName(res.data.serverObject.serverName);\r\n            } else if (res.status === 404) {\r\n                navigate('/picpark');\r\n            } \r\n        });\r\n    }, [navigate, params.serverId, updateServer]);\r\n\r\n    //Component hook for getting the list of members of the server.\r\n    useEffect(() => {\r\n       axios.get(`${Constants.SERVER_URL}/servers/serverUsers/${params.serverId}`, {headers: \r\n            {\r\n                \"x-access-token\": localStorage.getItem(\"authToken\")\r\n            }\r\n        }).then((res) => {\r\n            if (res.status === 200) {\r\n                setServerUsers(res.data);\r\n            }\r\n            setLoadedUsers(true);\r\n        }).catch((err) => {\r\n            setLoadedUsers(true);\r\n        })\r\n    }, [params.serverId]);\r\n\r\n     //Component hook for getting the server securities\r\n     useEffect(() => {\r\n        axios.get(`${Constants.SERVER_URL}/servers/serverSecurities/${params.serverId}`, {headers: \r\n             {\r\n                 \"x-access-token\": localStorage.getItem(\"authToken\")\r\n             }\r\n         }).then((res) => {\r\n            if (res.status === 200) {\r\n                setPostsVisibility(res.data.serverSecurities.postsVisibility);\r\n                setAllowJoin(res.data.serverSecurities.allowJoin);\r\n                setAllowComment(res.data.serverSecurities.allowComment);\r\n                setUsersVisibility(res.data.serverSecurities.usersVisibility);\r\n            }\r\n\r\n             setLoadedSecurities(true);\r\n\r\n         })\r\n     }, [params.serverId]);\r\n\r\n    //Save changes made to the server.\r\n    const saveChanges = () => {\r\n        const fd = new FormData();\r\n\r\n        fd.append(\"editServerName\", editServerName);\r\n\r\n        fd.append(\"postsVisibility\", postsVisibility);\r\n\r\n        fd.append(\"allowJoin\", allowJoin);\r\n\r\n        fd.append(\"allowComment\", allowComment);\r\n\r\n        fd.append(\"usersVisibility\", usersVisibility);\r\n\r\n        if (formRef.current.files[0] && formRef.current.files[0].name) {\r\n            fd.append('file-upload', formRef.current.files[0], formRef.current.files[0].name);\r\n        }\r\n\r\n        if ((!formRef.current.files[0]) || (formRef.current.files[0].type.split('/')[0] === \"image\")) {\r\n\r\n            axios.post(`${Constants.SERVER_URL}/servers/updateServer/${server._id}`, fd, {\r\n                headers: {\r\n                    'x-access-token': localStorage.getItem(\"authToken\"),\r\n                    'Content-Type': 'multipart/form-data'\r\n                }\r\n            })\r\n            .then((res) => {\r\n                if (res.status === 200) {\r\n                    setUpdateServer(!updateServer);\r\n                    setMadeChanges(false);\r\n                    props.refreshLeftSidebar();\r\n                } \r\n            })\r\n            .catch((err) => {\r\n            });\r\n        } else {\r\n            //err\r\n        };\r\n\r\n       \r\n    }\r\n\r\n    /////////////////////Leave Server Modal//////////////////////////////\r\n\r\n    //Opens up the leave server confirmation modal when the user clicks the Leave Server button\r\n    const leaveServer = () => {\r\n        setLeaveModalStage(0);\r\n        setShowLeaveModal(true);\r\n    }\r\n    \r\n    //Confirms that a user wishes to leave the server. If there are no other admins in the server, the user will get a\r\n    //confirmation that they wish to delete the server instead.\r\n    const leaveServerConfirm = () => {\r\n        if (leaveModalStage === 0) {\r\n            axios.delete(`${Constants.SERVER_URL}/servers/leaveServer/${params.serverId}`, {headers: \r\n                {\r\n                    \"x-access-token\": localStorage.getItem(\"authToken\")\r\n                }\r\n            }).then((res) => {\r\n                if (res.status === 200) {\r\n                    props.refreshLeftSidebar();\r\n                    setUserPermission(0);\r\n                    setShowLeaveModal(false);\r\n                } else if (res.status === 202) {\r\n                    setLeaveModalStage(1)\r\n                    setShowLeaveModal(true);\r\n                }\r\n            });\r\n        } else if (leaveModalStage === 1) {\r\n            axios.delete(`${Constants.SERVER_URL}/servers/deleteServer/${params.serverId}`, {headers: \r\n                {\r\n                    \"x-access-token\": localStorage.getItem(\"authToken\")\r\n                }\r\n            }).then((res) => {\r\n                props.refreshLeftSidebar();\r\n                navigate(\"/picpark\");\r\n            });\r\n        }\r\n        \r\n    }\r\n\r\n    //Close the leave server modal.\r\n    const leaveServerCancel = () => {\r\n        setLeaveModalStage(0);\r\n        setShowLeaveModal(false);\r\n    }\r\n\r\n    ////////////////////////Change rank modal///////////////////////////////////\r\n\r\n    //Open the change user rank modal.\r\n    const openChangeRankModal = (userId, username, serverPermission) => {\r\n        setRankRadio(serverPermission);\r\n        setRankModalProfile({userId: userId, username: username});\r\n        setShowRankModal(true);\r\n    }\r\n\r\n    //Handles modifying the user rank radio options.\r\n    const changeRankModalRadio = (e) => {\r\n        switch (e.target.id) {\r\n            case ('status-radio-0'):\r\n                setRankRadio(0);\r\n                break;\r\n            case ('status-radio-1'):\r\n                setRankRadio(1);\r\n                break;\r\n            case ('status-radio-2'):\r\n                setRankRadio(2);\r\n                break;\r\n            case ('status-radio-3'):\r\n                setRankRadio(3);\r\n                break;\r\n            case ('status-radio-4'):\r\n                setRankRadio(4);\r\n                break;\r\n            case ('status-radio-5'):\r\n                setRankRadio(5);\r\n                break;\r\n            default:\r\n                //do nothing\r\n                break;\r\n        }\r\n    }\r\n\r\n    //Sends a request to the server to change the rank of a user.\r\n    const changeRank = () => {\r\n        const fd = new FormData();\r\n        axios.post(`${Constants.SERVER_URL}/servers/changeRank/${server._id}/${rankModalProfile.userId}/${rankRadio}`, fd, {\r\n                headers: {\r\n                    'x-access-token': localStorage.getItem(\"authToken\")\r\n                }\r\n            })\r\n            .then((res) => {\r\n                if (res.status === 200) {\r\n                    setShowRankModal(false);\r\n                } \r\n            })\r\n            .catch((err) => {\r\n            });\r\n    }\r\n\r\n     //Returns the user to the previous page.\r\n     const exitViewServer = () => {\r\n        navigate(-1);\r\n    }\r\n\r\n    //////////////////////Avatar change stuff////////////////\r\n\r\n    //Event for when the user mouses over the avatar\r\n    const mouseOverEvent = (e) => {\r\n        if (userPermission >= 5) {\r\n            setHoverOverAvatar(true);\r\n        }\r\n    }\r\n\r\n    //Event for when the user is no longer mousing over the avatar\r\n    const mouseLeaveEvent = (e) => {\r\n        if (userPermission >= 5) {\r\n            setHoverOverAvatar(false);\r\n        }\r\n    }\r\n\r\n    //Event for when the user clicks the avatar\r\n    const onClickAvatar = (e) => {\r\n        if (userPermission >= 5) {\r\n            formRef.current.click();\r\n        }\r\n    }\r\n\r\n    //Sets the thumbnail avatar to be a new one, and readies the data for uploading.\r\n    const changeAvatar = (e) => {\r\n        if ((formRef.current.files[0].type.split('/')[0] === \"image\")) {\r\n            var reader = new FileReader();\r\n            reader.onload = function () {\r\n                setPreviewAvatar(reader.result);\r\n            }\r\n            reader.readAsDataURL(formRef.current.files[0]);\r\n            setMadeChanges(true);\r\n            \r\n        } else {\r\n            //display error\r\n        }\r\n    }\r\n\r\n    //Triggers onchange in serverName field.\r\n    const serverNameEvent = (e) => {\r\n        setEditServerName(e.target.value)\r\n        setMadeChanges(true);\r\n    }\r\n\r\n    //Handles radio options for server security.\r\n    const securitySettingEvent = (e) => {\r\n        setMadeChanges(true);\r\n        switch (e.target.id) {\r\n            case ('security-radio-0-0'):\r\n                setPostsVisibility(0);\r\n                break;\r\n            case ('security-radio-0-1'):\r\n                setPostsVisibility(1);\r\n                break;\r\n            case ('security-radio-1-0'):\r\n                setAllowJoin(0);\r\n                break;\r\n            case ('security-radio-1-1'):\r\n                setAllowJoin(1);\r\n                break;\r\n            case ('security-radio-2-0'):\r\n                setAllowComment(0);\r\n                break;\r\n            case ('security-radio-2-1'):\r\n                setAllowComment(1);\r\n                break;\r\n            case ('security-radio-3-0'):\r\n                setUsersVisibility(0);\r\n                break;\r\n            case ('security-radio-3-1'):\r\n                setUsersVisibility(1);\r\n                break;\r\n            default:\r\n                //do nothing\r\n                break;\r\n        }\r\n    }\r\n\r\n    //Sends the user to the Main component of the server they're viewing the information of.\r\n    const visitServer = () => {\r\n        navigate(`/picpark/s/${server._id}`);\r\n    }\r\n    \r\n    return (\r\n        <div className=\"text-center position-relative w-100 h-100\">\r\n            <i className=\"bi bi-x-circle position-absolute top-0 end-0 fa-lg\" onClick={exitViewServer}></i>\r\n\r\n        <Modal show={showLeaveModal} onHide={() => setShowLeaveModal(false)}>\r\n            <Modal.Body>{modalTextDict[leaveModalStage]}</Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={leaveServerCancel}>\r\n                    Close\r\n                </Button>\r\n                <Button variant=\"primary\" onClick={leaveServerConfirm}>\r\n                    Confirm\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n\r\n        <Modal show={showRankModal} onHide={() => setShowRankModal(false)}>\r\n            <Modal.Body>\r\n                <Form>\r\n                    <Form.Label className=\"my-auto col-md-6\">Set User Status for {rankModalProfile.username}</Form.Label>\r\n                        <div className=\"ps-5 my-auto col-md-6 border-start border-secondary\">\r\n                            <Form.Check type='radio' id={`status-radio-0`} label={`Banned`} checked={rankRadio === 0} onChange={changeRankModalRadio}/>\r\n                            <Form.Check type='radio' id={`status-radio-1`} label={`Non-Member`} checked={rankRadio === 1} onChange={changeRankModalRadio}/>\r\n                            <Form.Check type='radio' id={`status-radio-2`} label={`Member`} checked={rankRadio === 2} onChange={changeRankModalRadio}/>\r\n                            <Form.Check type='radio' id={`status-radio-3`} label={`Super Member`} checked={rankRadio === 3} onChange={changeRankModalRadio}/>\r\n                            <Form.Check type='radio' id={`status-radio-4`} label={`Moderator`} checked={rankRadio === 4} onChange={changeRankModalRadio}/>\r\n                            <Form.Check type='radio' id={`status-radio-5`} label={`Admin`} checked={rankRadio === 5} onChange={changeRankModalRadio}/>\r\n                        </div>\r\n                </Form>\r\n\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={() => setShowRankModal(false)}>\r\n                    Close\r\n                </Button>\r\n                <Button variant=\"primary\" onClick={changeRank}>\r\n                    Confirm\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n\r\n            {server ?\r\n\r\n            <div className=\"container start-50 translate-middle-x top-0 position-absolute w-100 mt-4 m-1 border border-secondary p-3\">\r\n                <div className=\"row \">\r\n                    <div className=\"col-md-4 position-relative\"  >\r\n                        <div className=\"position-relative\" onMouseOver={mouseOverEvent} onMouseLeave={mouseLeaveEvent} onClick={onClickAvatar}>\r\n                            {hoverOverAvatar ? <img alt=\"Click to change the avatar.\" style={{borderRadius:'50%', objectFit:'cover', height:'100px', width:'100px'}} className=\"thumbnail-image start-50 top-50 translate-middle position-absolute\" src={`${process.env.PUBLIC_URL}/images/server_default.png`}/> : \"\"}\r\n                            <Avatar large={true} localPreview={previewAvatar} avatarPostId={server.avatarPostId}/>\r\n                            <input type=\"file\" onChange={changeAvatar} name=\"file-upload\" id=\"file\" ref={formRef} style={{ display: \"none\" }}/>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"col-md-8 mt-5\">\r\n                        <div className=\"row\">\r\n                            {(userPermission >= 5) ? \r\n                                <input maxLength={20} type=\"text\" value={editServerName} onInput={serverNameEvent} className=\"form-control w-75\" rows=\"1\" placeholder=\"Server Name\" aria-label=\"Server Name\"/>\r\n                            : server.serverName}     \r\n                        </div>\r\n                        <div className=\"row\">\r\n                            Server ID: {server._id}\r\n                        </div>\r\n                        {(userPermission >= 5) ? <div  className=\"justify-content-center mt-5 mx-auto text-center w-25 row\">\r\n                            {madeChanges ? <button type=\"button\" onClick={saveChanges} className=\"btn-md btn-outline-primary\">Save Changes</button> : \"Changes Saved\"}\r\n                        </div>\r\n                        : \"\"}\r\n                        \r\n                    </div>\r\n                </div>\r\n                <div className=\"row m-4\">\r\n                    <Tabs defaultActiveKey=\"users\" id=\"uncontrolled-tab-example\" className=\"mb-3\">\r\n                        <Tab eventKey=\"users\" title=\"Users\">\r\n                            <div className=\"container\">\r\n                                {serverUsers && userPermission ?\r\n                                    <div className=\"row\">\r\n                                        {\r\n                                            serverUsers.map((el, i) => {\r\n                                                return(\r\n                                                    (el.permissions) > 0 ?\r\n                                                        <div className=\"col-md-4\" key={el._id}>\r\n                                                            <div className=\"row\">\r\n                                                                <UserThumbnail userId={el.userId} changeRankCallback={openChangeRankModal} serverId={params.serverId} userPermission={userPermission}/>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    : \"\"\r\n                                                )\r\n                                            })\r\n                                        }\r\n                                    </div>\r\n                                : (loadedUsers ? \"You do not have permission to view this server's users.\" : <Loading/>)}\r\n                            </div>\r\n                        </Tab>\r\n                        <Tab eventKey=\"settings\" title=\"Server Settings\">\r\n                            {loadedSecurities ?\r\n                                <Form>\r\n                                    <div className=\"row\">\r\n                                        <Form.Label className=\"my-auto col-md-6\">Who can view posts?</Form.Label>\r\n                                        <div className=\"ps-5 my-3 col-md-6 border-start border-secondary\">\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-0-0`} label={`Anyone`} checked={postsVisibility === 0} onChange={securitySettingEvent}/>\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-0-1`} label={`Members Only`} checked={postsVisibility === 1} onChange={securitySettingEvent}/>\r\n                                        </div>\r\n                                        <Form.Label className=\"my-auto col-md-6\">Who can join?</Form.Label>\r\n                                        <div className=\"ps-5 my-3 col-md-6 border-start border-secondary\">\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-1-0`} label={`Anyone with a link`} checked={allowJoin === 0} onChange={securitySettingEvent}/>\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-1-1`} label={`Nobody`} checked={allowJoin === 1} onChange={securitySettingEvent}/>\r\n                                        </div>\r\n                                        <Form.Label className=\"my-auto col-md-6\">Who can comment on posts?</Form.Label>\r\n                                        <div className=\"ps-5 my-3 col-md-6 border-start border-secondary\">\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-2-0`} label={`Anyone`} checked={allowComment === 0} onChange={securitySettingEvent}/>\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-2-1`} label={`Members`} checked={allowComment === 1} onChange={securitySettingEvent}/>\r\n                                        </div>\r\n                                        <Form.Label className=\"my-auto col-md-6\">Who can view members of the server?</Form.Label>\r\n                                        <div className=\"ps-5 my-3 col-md-6 border-start border-secondary\">\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-3-0`} label={`Anyone`} checked={usersVisibility === 0} onChange={securitySettingEvent}/>\r\n                                            <Form.Check disabled={userPermission < 5} type='radio' id={`security-radio-3-1`} label={`Members`} checked={usersVisibility === 1} onChange={securitySettingEvent}/>\r\n                                        </div>\r\n                                    </div>\r\n                                </Form>\r\n                            : <Loading/>}\r\n                        </Tab>\r\n                        <Tab eventKey=\"banned\" title=\"Banned Users\">\r\n                        <div className=\"container\">\r\n                                {serverUsers && userPermission ?\r\n                                    <div className=\"row\">\r\n                                        {\r\n                                            serverUsers.map((el, i) => {\r\n                                                return(\r\n                                                    (el.permissions === 0) ?\r\n                                                        <div className=\"col-md-4\" key={el._id}>\r\n                                                            <div className=\"row\">\r\n                                                                <UserThumbnail userId={el.userId} changeRankCallback={openChangeRankModal} serverId={params.serverId} userPermission={userPermission}/>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    : \"\"\r\n                                                )\r\n                                            })\r\n                                        }\r\n                                    </div>\r\n                                : (loadedUsers ? \"You do not have permission to view this server's users.\" : <Loading/>)}\r\n                            </div>\r\n                        </Tab>\r\n                    </Tabs>\r\n                </div>\r\n\r\n                <div className=\"row justify-content-end\">\r\n                    <div className=\"col-md-6\">\r\n                        {(userPermission >= 2) ? \r\n                            <div className=\"row\">\r\n                                <button type=\"button\" onClick={leaveServer} className=\"w-100 my-2 btn-md btn-outline-primary\">Leave Server</button>\r\n                            </div>\r\n                        : \"\"}\r\n                    </div>\r\n                    <div className=\"col-md-6\">\r\n                        <button type=\"button\" onClick={visitServer} className=\"w-100 my-2 btn-md btn-outline-primary\">Visit Server</button>\r\n                    </div>\r\n                </div>\r\n                \r\n                \r\n                \r\n            </div>\r\n\r\n            : <Loading/> }\r\n            \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ViewServer;"]},"metadata":{},"sourceType":"module"}