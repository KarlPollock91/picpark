{"ast":null,"code":"import _slicedToArray from\"C:/Users/KarlP/new-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";//Written by Karl Pollock, 2022.\n//KarlPollock91@gmail.com\n//www.karlpollock.com\n//CommentSecton.js is a secondary component that is a child of ViewPost. Here, users can read comments and comment on a post.\nimport React,{useEffect,useState}from'react';import axios from'axios';import*as Constants from'../../utils/constants';import CommentThumbnail from'../thumbnails/CommentThumbnail';import'../css/Thumbnail.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CommentSection(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),updateComments=_useState4[0],setUpdateComments=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newComment=_useState6[0],setNewComment=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),errorMessage=_useState8[0],setErrorMessage=_useState8[1];//Component hook to get the comments on a post.\nuseEffect(function(){axios.get(\"\".concat(Constants.SERVER_URL,\"/posts/getComments/\").concat(props.serverId,\"/\").concat(props.postId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setComments(res.data);}});},[updateComments,props.serverId,props.postId]);//Delete a comment by ID.\nvar deleteComment=function deleteComment(commentId){axios.delete(\"\".concat(Constants.SERVER_URL,\"/posts/deleteComment/\").concat(props.serverId,\"/\").concat(commentId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setUpdateComments(!updateComments);}});};//Sends post to server to add comment to comments.\nvar makeComment=function makeComment(e){var fd=new FormData();fd.append(\"commentText\",newComment);axios.post(\"\".concat(Constants.SERVER_URL,\"/posts/makeComment/\").concat(props.serverId,\"/\").concat(props.postId),fd,{headers:{\"x-access-token\":localStorage.getItem(\"authToken\"),'Content-Type':'multipart/form-data'}}).then(function(res){if(res.status===200){setNewComment('');setUpdateComments(!updateComments);}}).catch(function(err){setErrorMessage(\"You do not have permission to comment in this server.\");});};//Enter pressed in the comment text field.\nvar submitComment=function submitComment(e){if(e.keyCode===13&&e.shiftKey===false){e.preventDefault();makeComment(e);}};return/*#__PURE__*/_jsx(\"div\",{className:\"col border border-secondary content-comment mb-4 \",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"list-group w-100\",children:[errorMessage,/*#__PURE__*/_jsxs(\"div\",{className:\"border-bottom border-secondary pb-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",value:newComment,onInput:function onInput(e){return setNewComment(e.target.value);},className:\"form-control mt-3\",rows:\"2\",placeholder:\"Comment\",\"aria-label\":\"Comment\",onKeyDown:submitComment}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-secondary\",onClick:makeComment,children:\"Post Comment\"})]}),comments.map(function(el,i){return/*#__PURE__*/_jsx(CommentThumbnail,{deleteCommentCallback:deleteComment,commentObject:el},el._id);})]})});}export default CommentSection;","map":{"version":3,"sources":["C:/Users/KarlP/new-app/client/src/components/secondary/CommentSection.js"],"names":["React","useEffect","useState","axios","Constants","CommentThumbnail","CommentSection","props","comments","setComments","updateComments","setUpdateComments","newComment","setNewComment","errorMessage","setErrorMessage","get","SERVER_URL","serverId","postId","headers","localStorage","getItem","then","res","status","data","deleteComment","commentId","delete","makeComment","e","fd","FormData","append","post","catch","err","submitComment","keyCode","shiftKey","preventDefault","target","value","map","el","i","_id"],"mappings":"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","sourcesContent":["//Written by Karl Pollock, 2022.\r\n//KarlPollock91@gmail.com\r\n//www.karlpollock.com\r\n\r\n//CommentSecton.js is a secondary component that is a child of ViewPost. Here, users can read comments and comment on a post.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport axios from 'axios';\r\nimport * as Constants from '../../utils/constants';\r\nimport CommentThumbnail from '../thumbnails/CommentThumbnail'\r\nimport '../css/Thumbnail.css';\r\n\r\nfunction CommentSection(props) {\r\n\r\n    const [comments, setComments] = useState([]);\r\n    const [updateComments, setUpdateComments] = useState(true);\r\n    const [newComment, setNewComment] = useState('');\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n\r\n    //Component hook to get the comments on a post.\r\n    useEffect(() => {\r\n        axios.get(`${Constants.SERVER_URL}/posts/getComments/${props.serverId}/${props.postId}`, {headers: \r\n                {\r\n                    \"x-access-token\": localStorage.getItem(\"authToken\")\r\n                }\r\n            })\r\n            .then((res) => {\r\n                if (res.status === 200){\r\n                    setComments(res.data);  \r\n                }\r\n            });\r\n    }, [updateComments, props.serverId, props.postId]);\r\n\r\n    //Delete a comment by ID.\r\n    const deleteComment = (commentId) => {\r\n        axios.delete(`${Constants.SERVER_URL}/posts/deleteComment/${props.serverId}/${commentId}`, {headers: \r\n        {\r\n            \"x-access-token\": localStorage.getItem(\"authToken\")\r\n        }})\r\n        .then((res) => {\r\n            if (res.status === 200){\r\n                setUpdateComments(!updateComments);\r\n            }\r\n        });\r\n    }\r\n\r\n    //Sends post to server to add comment to comments.\r\n    const makeComment = (e) => {\r\n        const fd = new FormData();\r\n        fd.append(\"commentText\", newComment);\r\n\r\n        axios.post(`${Constants.SERVER_URL}/posts/makeComment/${props.serverId}/${props.postId}`, fd,\r\n            {\r\n                headers: \r\n                    {\r\n                        \"x-access-token\": localStorage.getItem(\"authToken\"),\r\n                        'Content-Type': 'multipart/form-data'\r\n                    }\r\n            })\r\n        .then((res) => {\r\n            if (res.status === 200){\r\n                setNewComment('');\r\n                setUpdateComments(!updateComments);\r\n            }\r\n        }).catch((err) => {\r\n            setErrorMessage(\"You do not have permission to comment in this server.\");\r\n        });\r\n    }\r\n\r\n     //Enter pressed in the comment text field.\r\n     const submitComment = (e) => {\r\n        if(e.keyCode === 13 && e.shiftKey === false) {\r\n          e.preventDefault();\r\n          makeComment(e);\r\n\r\n        }\r\n    }\r\n\r\n    return(\r\n        <div className=\"col border border-secondary content-comment mb-4 \">\r\n            <ul className=\"list-group w-100\">\r\n                    {errorMessage}\r\n                    <div className=\"border-bottom border-secondary pb-2\">\r\n                    <textarea type=\"text\" value={newComment} onInput={e => setNewComment(e.target.value)} className=\"form-control mt-3\" rows=\"2\" placeholder=\"Comment\" aria-label=\"Comment\" onKeyDown={submitComment}/>\r\n                    <button type=\"button\" className=\"btn btn-outline-secondary\" onClick={makeComment}>Post Comment</button>\r\n                    </div>\r\n                    {comments.map((el, i) => (\r\n                        <CommentThumbnail   key={el._id}\r\n                                            deleteCommentCallback={deleteComment}\r\n                                            commentObject={el}/>\r\n                    ))}\r\n            </ul>\r\n        </div>\r\n\r\n    );\r\n}\r\n\r\nexport default CommentSection;"]},"metadata":{},"sourceType":"module"}