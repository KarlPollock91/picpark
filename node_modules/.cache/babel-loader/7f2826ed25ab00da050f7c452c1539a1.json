{"ast":null,"code":"import _slicedToArray from\"C:/Users/KarlP/new-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";//Written by Karl Pollock, 2022.\n//KarlPollock91@gmail.com\n//www.karlpollock.com\n//ViewPost.js allows a user to view the post, who made it and when, as well as comment and read comments written on the post.\nimport React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate,useParams}from'react-router-dom';import{Dropdown,DropdownButton}from'react-bootstrap';import'../css/ViewPost.css';import*as Constants from'../../utils/constants';import UserThumbnail from'../thumbnails/UserThumbnail';import CommentSection from'../secondary/CommentSection';import Loading from'../secondary/Loading';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ViewPost(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),userId=_useState2[0],setUserId=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),post=_useState4[0],setPost=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),displayPostText=_useState6[0],setDisplayPostText=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),editMode=_useState8[0],setEditMode=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),date=_useState10[0],setDate=_useState10[1];var navigate=useNavigate();var params=useParams();//Component hook to retrieve the post information from the server.\nuseEffect(function(){axios.get(\"\".concat(Constants.SERVER_URL,\"/servers/getPost/\").concat(params.serverId,\"/\").concat(params.postId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){setDate(new Date(res.data.post.date));setPost(res.data.post);setUserId(res.data.userId);setDisplayPostText(res.data.post.postText);}else if(res.status===404){navigate('/');}});},[navigate,params.postId,params.serverId]);//Sends inputted data to the server to edit the post.\nvar editPost=function editPost(){var fd=new FormData();fd.append(\"displayPostText\",displayPostText);axios.post(\"\".concat(Constants.SERVER_URL,\"/posts/editPost/\").concat(params.serverId,\"/\").concat(params.postId),fd,{headers:{\"x-access-token\":localStorage.getItem(\"authToken\"),'Content-Type':'multipart/form-data'}}).then(function(res){if(res.status===200){}else{setDisplayPostText(post.postText);}});};//Sends a request to the server to delete the post.\nvar deletePost=function deletePost(){axios.delete(\"\".concat(Constants.SERVER_URL,\"/posts/deletePost/\").concat(params.serverId,\"/\").concat(params.postId),{headers:{\"x-access-token\":localStorage.getItem(\"authToken\")}}).then(function(res){if(res.status===200){exitViewPost();}});};//Handles the drop down menu for the post.\nvar handleSelect=function handleSelect(e){if(e===\"edit\"){setEditMode(true);}else if(e===\"delete\"){deletePost();}};//Return to the Main view for the posts server.\nvar exitViewPost=function exitViewPost(){navigate(\"/s/\".concat(params.serverId));};return/*#__PURE__*/_jsxs(\"div\",{className:\"container text-center position-relative w-100 h-100\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-circle position-absolute top-0 end-0 fa-lg\",onClick:exitViewPost}),post?/*#__PURE__*/_jsxs(\"div\",{className:\"row start-50 translate-middle-x top-0 position-absolute w-100 mt-4 m-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[post.dataType!==\"text\"?/*#__PURE__*/_jsxs(\"div\",{className:\"row border border-secondary content-viewer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute end-0 me-4 mt-2\",children:post.authorId===userId?/*#__PURE__*/_jsxs(DropdownButton,{title:\"\",id:\"dropdown-basic-button\",variant:\"secondary\",size:\"sm\",onSelect:handleSelect,children:[/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"edit\",children:\"Edit\"}),/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"delete\",children:\"Delete\"})]}):\"\"}),/*#__PURE__*/_jsx(\"div\",{children:post.dataType===\"image\"?/*#__PURE__*/_jsx(\"img\",{alt:\"Posted by user with ID \".concat(post.authorId),className:\"img-fluid my-3 mx-auto d-block\",src:\"\".concat(Constants.SERVER_URL,\"/files/image/\").concat(post.dataId)}):null})]}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"row border border-secondary\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-4 my-auto border-end border-secondary\",children:date?date.toDateString():\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-8\",children:/*#__PURE__*/_jsx(UserThumbnail,{userId:post.authorId})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row border border-secondary content-text mb-4 h-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-2\",children:editMode?/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",value:displayPostText,onInput:function onInput(e){return setDisplayPostText(e.target.value);},className:\"form-control mt-3\",rows:\"2\",placeholder:\"Edit Post\",\"aria-label\":\"Edit Post\"}):displayPostText})})]}),userId?/*#__PURE__*/_jsx(CommentSection,{userId:userId,serverId:params.serverId,postId:params.postId}):/*#__PURE__*/_jsx(Loading,{})]}):/*#__PURE__*/_jsx(Loading,{})]});}export default ViewPost;","map":{"version":3,"sources":["C:/Users/KarlP/new-app/client/src/components/main/ViewPost.js"],"names":["React","useState","useEffect","axios","useNavigate","useParams","Dropdown","DropdownButton","Constants","UserThumbnail","CommentSection","Loading","ViewPost","props","userId","setUserId","post","setPost","displayPostText","setDisplayPostText","editMode","setEditMode","date","setDate","navigate","params","get","SERVER_URL","serverId","postId","headers","localStorage","getItem","then","res","status","Date","data","postText","editPost","fd","FormData","append","deletePost","delete","exitViewPost","handleSelect","e","dataType","authorId","dataId","toDateString","target","value"],"mappings":"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","sourcesContent":["//Written by Karl Pollock, 2022.\r\n//KarlPollock91@gmail.com\r\n//www.karlpollock.com\r\n\r\n//ViewPost.js allows a user to view the post, who made it and when, as well as comment and read comments written on the post.\r\n\r\nimport React, {useState, useEffect} from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, useParams} from 'react-router-dom';\r\nimport {Dropdown, DropdownButton} from 'react-bootstrap';\r\n\r\nimport '../css/ViewPost.css'\r\nimport * as Constants from '../../utils/constants';\r\n\r\nimport UserThumbnail from '../thumbnails/UserThumbnail';\r\nimport CommentSection from '../secondary/CommentSection';\r\nimport Loading from '../secondary/Loading';\r\n\r\nfunction ViewPost(props) {\r\n    \r\n    const [userId, setUserId] = useState('');\r\n    const [post, setPost] = useState({});\r\n    const [displayPostText, setDisplayPostText] = useState('');\r\n    const [editMode, setEditMode] = useState(false);\r\n    const [date, setDate] = useState('');\r\n\r\n    const navigate = useNavigate();\r\n    const params = useParams();\r\n  \r\n    //Component hook to retrieve the post information from the server.\r\n    useEffect(() => {\r\n        axios.get(`${Constants.SERVER_URL}/servers/getPost/${params.serverId}/${params.postId}`, {headers: \r\n                {\r\n                    \"x-access-token\": localStorage.getItem(\"authToken\")\r\n                }\r\n        }).then((res) => {\r\n            if (res.status === 200) {\r\n                setDate(new Date(res.data.post.date));\r\n                setPost(res.data.post);\r\n                setUserId(res.data.userId);\r\n                setDisplayPostText(res.data.post.postText);\r\n            } else  if (res.status === 404) {\r\n                navigate('/');\r\n            }\r\n\r\n        })\r\n    }, [navigate, params.postId, params.serverId]);\r\n\r\n    //Sends inputted data to the server to edit the post.\r\n    const editPost = () => {\r\n        const fd = new FormData();\r\n        fd.append(\"displayPostText\", displayPostText);\r\n\r\n        axios.post(`${Constants.SERVER_URL}/posts/editPost/${params.serverId}/${params.postId}`, fd,\r\n            {\r\n                headers: \r\n                    {\r\n                        \"x-access-token\": localStorage.getItem(\"authToken\"),\r\n                        'Content-Type': 'multipart/form-data'\r\n                    }\r\n            })\r\n            .then((res) => {\r\n                if (res.status === 200){\r\n                    \r\n                } else {\r\n                    setDisplayPostText(post.postText);\r\n                }\r\n            });\r\n    }\r\n\r\n    //Sends a request to the server to delete the post.\r\n    const deletePost = () => {\r\n        axios.delete(`${Constants.SERVER_URL}/posts/deletePost/${params.serverId}/${params.postId}`, {headers: \r\n        {\r\n            \"x-access-token\": localStorage.getItem(\"authToken\")\r\n        }})\r\n        .then((res) => {\r\n            if (res.status === 200){\r\n                exitViewPost();\r\n            }\r\n        });\r\n    }\r\n\r\n    //Handles the drop down menu for the post.\r\n    const handleSelect = (e) => {\r\n        if (e === \"edit\"){\r\n            setEditMode(true);\r\n        } else if (e === \"delete\"){\r\n            deletePost();\r\n        }\r\n    }\r\n\r\n    //Return to the Main view for the posts server.\r\n    const exitViewPost = () => {\r\n        navigate(`/s/${params.serverId}`);\r\n    }\r\n\r\n   \r\n\r\n    return (\r\n        <div className=\"container text-center position-relative w-100 h-100\">\r\n            <i className=\"bi bi-x-circle position-absolute top-0 end-0 fa-lg\" onClick={exitViewPost}></i>\r\n            {post ?\r\n\r\n                <div className=\"row start-50 translate-middle-x top-0 position-absolute w-100 mt-4 m-1\">\r\n                    <div className=\"col\">\r\n                        {post.dataType !== \"text\" ?\r\n                            <div className=\"row border border-secondary content-viewer\">\r\n                                <div className=\"position-absolute end-0 me-4 mt-2\">\r\n                                    {(post.authorId === userId) ?\r\n                                        <DropdownButton title=\"\" id=\"dropdown-basic-button\" variant=\"secondary\" size=\"sm\" onSelect={handleSelect}>\r\n                                            <Dropdown.Item eventKey=\"edit\">Edit</Dropdown.Item>\r\n                                            <Dropdown.Item eventKey=\"delete\">Delete</Dropdown.Item>\r\n                                        </DropdownButton>\r\n                                    : \"\"}\r\n                                </div>\r\n                                <div>\r\n                                    {post.dataType === \"image\" ? <img alt={`Posted by user with ID ${post.authorId}`}  className=\"img-fluid my-3 mx-auto d-block\" src={`${Constants.SERVER_URL}/files/image/${post.dataId}`}/> : null}\r\n                                </div>\r\n                            </div>\r\n                        : null} \r\n\r\n                        <div className=\"row border border-secondary\">\r\n                            <div className=\"col-4 my-auto border-end border-secondary\">\r\n                                {date ?\r\n                                    date.toDateString()\r\n                                : \"\"}\r\n                            </div>\r\n                            <div className=\"col-8\">\r\n                                <UserThumbnail userId={post.authorId}/>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"row border border-secondary content-text mb-4 h-auto\">\r\n                            <div className=\"p-2\">\r\n                                {\r\n                                    editMode \r\n                                    ?\r\n                                    <textarea type=\"text\" value={displayPostText} onInput={e => setDisplayPostText(e.target.value)} className=\"form-control mt-3\" rows=\"2\" placeholder=\"Edit Post\" aria-label=\"Edit Post\"/>\r\n                                    :\r\n                                    displayPostText\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {userId ?\r\n                        <CommentSection userId={userId} serverId={params.serverId} postId={params.postId}/>\r\n                    : <Loading/>} \r\n                </div>\r\n\r\n            : <Loading/>}\r\n            \r\n        </div>\r\n  );\r\n}\r\n\r\nexport default ViewPost;"]},"metadata":{},"sourceType":"module"}